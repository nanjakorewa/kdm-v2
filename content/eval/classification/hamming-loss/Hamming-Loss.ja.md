---
title: "ハミング損失（Hamming Loss）"
pre: "4.3.13 "
weight: 13
title_suffix: "マルチラベル分類の誤り率を測る"
---

{{< lead >}}
ハミング損失（Hamming Loss）は、マルチラベル分類やマルチクラス分類で「誤ったラベルの割合」を測る指標です。平均的に何個のラベルを間違えているかをシンプルに把握できます。
{{< /lead >}}

---

## 1. 定義

真のラベル集合を \\(Y_i\\)、予測ラベル集合を \\(\hat{Y}_i\\)、全ラベル数を \\(L\\) とすると、

$$
\mathrm{Hamming\ Loss} = \frac{1}{nL} \sum_{i=1}^n | Y_i \triangle \hat{Y}_i |
$$

ここで \\(| Y \triangle \hat{Y} |\\) は対称差（片方にのみ含まれるラベル数）です。マルチラベルであれば、1 サンプル当たりの誤りラベル数の平均になります。

---

## 2. Python で計算

```python
from sklearn.metrics import hamming_loss

print("Hamming Loss:", hamming_loss(y_true, y_pred))
```

`y_true`、`y_pred` はマルチホット表現（0/1 の配列）を渡します。スパースな `MultiLabelBinarizer` の結果を利用すると便利です。

---

## 3. スコアの解釈

- 0 に近いほど良い（完全一致で 0）。
- 0.05 なら「全ラベルのうち 5% を誤っている」ことを意味します。
- 1 ラベル単位で等価に扱うため、重要度が異なるラベルが混じる場合は重み付きハミング損失を検討します。

---

## 4. 他指標との比較

| 指標 | 特徴 | 用途 |
| --- | --- | --- |
| Exact Match | 完全一致率 | ラベル集合が完全一致した割合。厳しい |
| **Hamming Loss** | ラベル単位の誤り率 | 平均的な誤り数を知りたいとき |
| Micro F1 | 平均適合率・再現率 | ラベルの正例/負例のバランスを考慮 |
| Jaccard 指数 | 集合の類似度 | ラベル集合全体のオーバーラップ |

ハミング損失は Exact Match ほど厳しくないため、改善度合いを段階的に把握するのに便利です。

---

## 5. 実務でのヒント

- **タグ推薦**：1 記事につき複数タグを予測する場合、ハミング損失で平均的なタグ誤り数を把握できる。
- **異常検知（ルールセット）**：複数のアラートを同時に判定する場面で、どの程度誤警報があるかを定量化。
- **重みづけ**：重要度が異なるラベルは、ラベルごとに重みを掛けた加重ハミング損失で評価する。

---

## まとめ

- ハミング損失はラベル単位の誤り率を測り、マルチラベル分類の改善指標として扱いやすい。
- `hamming_loss` で簡単に算出でき、Exact Match や F1 と併用して総合的な性能を把握しよう。
- 重み付けやラベルごとの詳細分析と組み合わせ、誤りの多いラベルに対する改善策を検討する。

---

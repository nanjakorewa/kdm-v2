<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>時系列 on K_DM Book</title>
    <link>http://localhost:1313/basic/timeseries/</link>
    <description>Recent content in 時系列 on K_DM Book</description>
    <generator>Hugo</generator>
    <language>ja</language>
    <atom:link href="http://localhost:1313/basic/timeseries/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Prophetを使ってみる</title>
      <link>http://localhost:1313/basic/timeseries/prophet/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/basic/timeseries/prophet/</guid>
      <description>&lt;div class=&#34;youtube-embed&#34;&gt;&#xD;&#xA;  &lt;iframe loading=&#34;lazy&#34; class=&#34;youtube-video&#34; src=&#34;https://www.youtube.com/embed/uUMDo8HOcrI&#34; title=&#34;YouTube video player&#34; allow=&#34;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&#34; allowfullscreen&gt;&lt;/iframe&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;インストール方法は「&lt;a href=&#34;https://facebook.github.io/prophet/docs/installation.html&#34;&gt;prophet Installation&lt;/a&gt;」を参照してください。また、&#xA;公式ドキュメントのQuick Start（&lt;a href=&#34;https://facebook.github.io/prophet/docs/quick_start.html&#34;&gt;prophet | Quick Start&lt;/a&gt;）もご参照ください。&lt;/p&gt;&#xA;&#xD;&#xA;&lt;div class=&#34;notices seealso&#34; &gt;&lt;p&gt;&lt;a href=&#34;https://k-dm.work/ja/timeseries/forecast/001-prophet/&#34;&gt;K_DM - 時系列 &amp;gt; 予測 &amp;gt; Prophet&lt;/a&gt;でもProphetを扱っています。&#xA;こちらもご参照ください。また、時系列の続きは&lt;a href=&#34;https://k-dm.work/ja/timeseries/&#34;&gt;K_DM - 時系列&lt;/a&gt;に書いていきますのでそちらも参照してみてください。&lt;/p&gt;&#xA;&lt;/div&gt;&#xD;&#xA;&#xA;&lt;h2 id=&#34;時系列データの作成&#34;&gt;&#xA;  時系列データの作成&#xA;  &#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e6%99%82%e7%b3%bb%e5%88%97%e3%83%87%e3%83%bc%e3%82%bf%e3%81%ae%e4%bd%9c%e6%88%90&#34;&gt;#&lt;/a&gt;&#xA;  &#xA;&lt;/h2&gt;&#xA;&lt;p&gt;ダミーの時系列データを作成します。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; seaborn &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; sns&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; prophet &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Prophet&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set(rc&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;figure.figsize&amp;#34;&lt;/span&gt;: (&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;)})&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;実験用のデータを作成&#34;&gt;&#xA;  実験用のデータを作成&#xA;  &#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e5%ae%9f%e9%a8%93%e7%94%a8%e3%81%ae%e3%83%87%e3%83%bc%e3%82%bf%e3%82%92%e4%bd%9c%e6%88%90&#34;&gt;#&lt;/a&gt;&#xA;  &#xA;&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;date &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;date_range(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;2020-01-01&amp;#34;&lt;/span&gt;, periods&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;365&lt;/span&gt;, freq&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D&amp;#34;&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cos(di&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;weekday()) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; di&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;month &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;log(i &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i, di &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(date)]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame({&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ds&amp;#34;&lt;/span&gt;: date, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;y&amp;#34;&lt;/span&gt;: y})&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; date&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lineplot(data&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;df)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/basic/timeseries/prophet_files/prophet_3_1.png&#34; alt=&#34;png&#34; /&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;prophetの訓練&#34;&gt;&#xA;  Prophetの訓練&#xA;  &#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#prophet%e3%81%ae%e8%a8%93%e7%b7%b4&#34;&gt;#&lt;/a&gt;&#xA;  &#xA;&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;m &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Prophet(yearly_seasonality&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, daily_seasonality&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;m&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(df)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;Initial log joint probability = -24.5101&#xD;&#xA;&amp;lt;prophet.forecaster.Prophet at 0x7fe3b5d93d60&amp;gt;&#xD;&#xA;    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes &#xD;&#xA;      99       798.528    0.00821602       204.832           1           1      136   &#xD;&#xA;    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes &#xD;&#xA;     136       799.486    0.00040141       83.1101    5.02e-06       0.001      225  LS failed, Hessian reset &#xD;&#xA;     158       799.529    0.00027729       48.4168   3.528e-06       0.001      291  LS failed, Hessian reset &#xD;&#xA;     199        799.55   3.15651e-05       54.5691           1           1      345   &#xD;&#xA;    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes &#xD;&#xA;     204       799.553   3.54297e-05       56.7445    5.36e-07       0.001      397  LS failed, Hessian reset &#xD;&#xA;     267       799.556   6.19351e-08       44.7029      0.2081           1      490   &#xD;&#xA;Optimization terminated normally: &#xD;&#xA;  Convergence detected: relative gradient magnitude is below tolerance&#xD;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 id=&#34;予測用のデータを作成し予測を実行する&#34;&gt;&#xA;  予測用のデータを作成し予測を実行する&#xA;  &#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#%e4%ba%88%e6%b8%ac%e7%94%a8%e3%81%ae%e3%83%87%e3%83%bc%e3%82%bf%e3%82%92%e4%bd%9c%e6%88%90%e3%81%97%e4%ba%88%e6%b8%ac%e3%82%92%e5%ae%9f%e8%a1%8c%e3%81%99%e3%82%8b&#34;&gt;#&lt;/a&gt;&#xA;  &#xA;&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;future &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; m&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;make_future_dataframe(periods&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;forecast &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; m&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;predict(future)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fig1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; m&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(forecast)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/basic/timeseries/prophet_files/prophet_8_0.png&#34; alt=&#34;png&#34; /&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>

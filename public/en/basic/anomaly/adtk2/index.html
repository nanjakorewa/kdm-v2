<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Let&rsquo;s try anomaly detection using the Anomaly Detection Toolkit (ADTK).
We will apply anomaly detection to multidimensional synthetic data. This time, we will work with data across multiple dimensions.
import numpy as np
import pandas as pd
from adtk.data import validate_series

s_train = pd.read_csv(&#34;./training.csv&#34;, index_col=&#34;timestamp&#34;, parse_dates=True)
s_train = validate_series(s_train)
s_train[&#34;value2&#34;] = s_train[&#34;value&#34;].apply(lambda v: np.sin(v) &#43; np.cos(v))
s_train

.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}

">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/en/basic/anomaly/adtk2/">
  <meta property="og:site_name" content="K_DM Book">
  <meta property="og:title" content="Anomaly Detection②">
  <meta property="og:description" content="Let’s try anomaly detection using the Anomaly Detection Toolkit (ADTK).
We will apply anomaly detection to multidimensional synthetic data. This time, we will work with data across multiple dimensions.
import numpy as np import pandas as pd from adtk.data import validate_series s_train = pd.read_csv(&#34;./training.csv&#34;, index_col=&#34;timestamp&#34;, parse_dates=True) s_train = validate_series(s_train) s_train[&#34;value2&#34;] = s_train[&#34;value&#34;].apply(lambda v: np.sin(v) &#43; np.cos(v)) s_train .dataframe tbody tr th {vertical-align: top;}.dataframe thead th {text-align: right;}">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="basic">
<title>Anomaly Detection② | K_DM Book</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/en/basic/anomaly/adtk2/">
  <link rel="alternate" hreflang="ja" href="http://localhost:1313/basic/anomaly/adtk2/" title="異常検知②">
  <link rel="alternate" hreflang="es" href="http://localhost:1313/es/basic/anomaly/adtk2/" title="Detección de anomalías②">
  <link rel="alternate" hreflang="id" href="http://localhost:1313/id/basic/anomaly/adtk2/" title="Deteksi Anomali②">
<link rel="stylesheet" href="/book.min.5c80a20e1f11b0e9dc4cae70ce44083860ffa999a7bf8ab5dab38664fde8a418.css" integrity="sha256-XICiDh8RsOncTK5wzkQIOGD/qZmnv4q12rOGZP3opBg=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.8a44fa1abc5451ced25c796dc6ff27eb2d840fda90401b31bc09e7864db39f2e.js" integrity="sha256-ikT6GrxUUc7SXHltxv8n6y2ED9qQQBsxvAnnhk2zny4=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr" class="book-kind-page book-type-basic">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/en/"><span>K_DM Book</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>



  



  
    
  
    
  
    
  


  

  

  


<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex">
      <a role="button" class="flex flex-auto">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        <span>English</span>
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/basic/anomaly/adtk2/">
          <span>日本語</span>
        </a>
      </li>
      
      <li>
        <a href="/es/basic/anomaly/adtk2/">
          <span>Español</span>
        </a>
      </li>
      
      <li>
        <a href="/id/basic/anomaly/adtk2/">
          <span>Indonesia</span>
        </a>
      </li>
      
    </ul>
  </li>
</ul>














  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/" class="">Linear Regression</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/linear_regression/" class="">Least-squares method</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/ridge_and_lasso/" class="">Ridge and Lasso regression</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/robust_regression/" class="">Outliers and Robustness</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/classification/" class="">Linear Classification</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/classification/logistic_regression/" class="">Logistic Regression</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/classification/linear_discriminant_analysis/" class="">Linear Discriminant Analysis</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/" class="">Decision Tree</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/decision_tree_classifier/" class="">Decision Tree (Classification)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/decision_tree_regressor/" class="">Decision tree (regression)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/parameter/" class="">Decision Tree Parameters</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/" class="">Ensemble</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/randomforest/" class="">Random Forests</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/stucking/" class="">Stacking</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/adaboost_classification/" class="">Adaboost (classification)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/adaboost_regression/" class="">Adaboost(Regression)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/gradient_boosting1/" class="">Gradient boosting</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/" class="">Clustering</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/k-means1/" class="">k-means</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/k-means2/" class="">k-means&#43;&#43;</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/x-means/" class="">X-means</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/" class="">Dimensionality Reduction</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/pca/" class="">PCA</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/svd/" class="">SVD</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/lda/" class="">LDA</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/kernel-pca/" class="">Kernel-PCA</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/feature_selection/" class="">Feature Selection</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/timeseries/" class="">Time Series</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/timeseries/prophet/" class="">Using Prophet</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/anomaly/" class="">Anomaly detection</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/anomaly/adtk1/" class="">Anomaly Detection ①</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/anomaly/adtk2/" class="active">Anomaly Detection②</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Anomaly Detection②</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#comparison-of-anomaly-detection-methods">Comparison of Anomaly Detection Methods</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><p>Let&rsquo;s try anomaly detection using the <a href="https://adtk.readthedocs.io/en/stable/index.html">Anomaly Detection Toolkit (ADTK)</a>.<br>
We will apply anomaly detection to multidimensional synthetic data. This time, we will work with data across multiple dimensions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> adtk.data <span style="color:#f92672">import</span> validate_series
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s_train <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;./training.csv&#34;</span>, index_col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;timestamp&#34;</span>, parse_dates<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>s_train <span style="color:#f92672">=</span> validate_series(s_train)
</span></span><span style="display:flex;"><span>s_train[<span style="color:#e6db74">&#34;value2&#34;</span>] <span style="color:#f92672">=</span> s_train[<span style="color:#e6db74">&#34;value&#34;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> v: np<span style="color:#f92672">.</span>sin(v) <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>cos(v))
</span></span><span style="display:flex;"><span>s_train
</span></span></code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> adtk.visualization <span style="color:#f92672">import</span> plot
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plot(s_train)
</span></span></code></pre></div><p><img src="/images/basic/anomaly/adtk2_files/adtk2_2_1.png" alt="png" /></p>
<h2 id="comparison-of-anomaly-detection-methods">
  Comparison of Anomaly Detection Methods
  
  <a class="anchor" href="#comparison-of-anomaly-detection-methods">#</a>
  
</h2>
<p>We will perform anomaly detection using <a href="https://adtk.readthedocs.io/en/stable/notebooks/demo.html?highlight=SeasonalAD#SeasonalAD">SeasonalAD</a>.<br>
For other methods, refer to <a href="https://adtk.readthedocs.io/en/stable/notebooks/demo.html?highlight=SeasonalAD#Detector">Detector</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> adtk.detector <span style="color:#f92672">import</span> OutlierDetector, PcaAD, RegressionAD
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LinearRegression
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.neighbors <span style="color:#f92672">import</span> LocalOutlierFactor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model_dict <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;OutlierDetector&#34;</span>: OutlierDetector(LocalOutlierFactor(contamination<span style="color:#f92672">=</span><span style="color:#ae81ff">0.05</span>)),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;RegressionAD&#34;</span>: RegressionAD(regressor<span style="color:#f92672">=</span>LinearRegression(), target<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;value2&#34;</span>, c<span style="color:#f92672">=</span><span style="color:#ae81ff">3.0</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;PcaAD&#34;</span>: PcaAD(k<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> model_name, model <span style="color:#f92672">in</span> model_dict<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>    anomalies <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit_detect(s_train)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    plot(
</span></span><span style="display:flex;"><span>        s_train,
</span></span><span style="display:flex;"><span>        anomaly<span style="color:#f92672">=</span>anomalies,
</span></span><span style="display:flex;"><span>        ts_linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        ts_markersize<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>        anomaly_color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>,
</span></span><span style="display:flex;"><span>        anomaly_alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>,
</span></span><span style="display:flex;"><span>        curve_group<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;all&#34;</span>,
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(model_name)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/images/basic/anomaly/adtk2_files/adtk2_4_1.png" alt="png" /></p>
<p><img src="/images/basic/anomaly/adtk2_files/adtk2_4_3.png" alt="png" /></p>
<p><img src="/images/basic/anomaly/adtk2_files/adtk2_4_5.png" alt="png" /></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/en/basic/anomaly/adtk1/" class="flex align-center book-icon">
        <img src="/svg/backward.svg" class="book-icon" alt="Previous" title="Anomaly Detection ①" />
        <span>Anomaly Detection ①</span>
      </a>
    
    </span>
    <span>
    
    </span>
  </div>
  




  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 
      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    

<aside class="book-toc">
  <div class="book-toc-content">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#comparison-of-anomaly-detection-methods">Comparison of Anomaly Detection Methods</a></li>
  </ul>
</nav>



  </div>
</aside>

 
  </main>

  
</body>
</html>

















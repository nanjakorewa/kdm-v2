<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="

  Import required modules
  
  #
  

import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib
from sklearn.datasets import make_regression
from sklearn.linear_model import LinearRegression, Ridge, Lasso
from sklearn.model_selection import cross_val_score
from sklearn.pipeline import make_pipeline
from sklearn.preprocessing import StandardScaler

  Generate regression data for experiments
  
  #
  


sklearn.datasets.make_regression


Artificially generate regression data using sklearn.datasets.make_regression. Specify two features (n_informative = 2) as necessary for prediction. Otherwise, they are redundant features that are not useful for prediction.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/en/basic/regression/ridge_and_lasso/">
  <meta property="og:site_name" content="K_DM Book">
  <meta property="og:title" content="Ridge and Lasso regression">
  <meta property="og:description" content="Import required modules # import numpy as np import matplotlib.pyplot as plt import japanize_matplotlib from sklearn.datasets import make_regression from sklearn.linear_model import LinearRegression, Ridge, Lasso from sklearn.model_selection import cross_val_score from sklearn.pipeline import make_pipeline from sklearn.preprocessing import StandardScaler Generate regression data for experiments # sklearn.datasets.make_regression
Artificially generate regression data using sklearn.datasets.make_regression. Specify two features (n_informative = 2) as necessary for prediction. Otherwise, they are redundant features that are not useful for prediction.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="basic">
<title>Ridge and Lasso regression | K_DM Book</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/en/basic/regression/ridge_and_lasso/">
  <link rel="alternate" hreflang="ja" href="http://localhost:1313/basic/regression/ridge_and_lasso/" title="リッジ回帰・ラッソ回帰">
  <link rel="alternate" hreflang="es" href="http://localhost:1313/es/basic/regression/ridge_and_lasso/" title="Regresión Ridge y Lasso">
  <link rel="alternate" hreflang="id" href="http://localhost:1313/id/basic/regression/ridge_and_lasso/" title="Regresi Ridge dan Lasso">
<link rel="stylesheet" href="/book.min.5c80a20e1f11b0e9dc4cae70ce44083860ffa999a7bf8ab5dab38664fde8a418.css" integrity="sha256-XICiDh8RsOncTK5wzkQIOGD/qZmnv4q12rOGZP3opBg=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.8a44fa1abc5451ced25c796dc6ff27eb2d840fda90401b31bc09e7864db39f2e.js" integrity="sha256-ikT6GrxUUc7SXHltxv8n6y2ED9qQQBsxvAnnhk2zny4=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr" class="book-kind-page book-type-basic">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/en/"><span>K_DM Book</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>



  



  
    
  
    
  
    
  


  

  

  


<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex">
      <a role="button" class="flex flex-auto">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        <span>English</span>
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/basic/regression/ridge_and_lasso/">
          <span>日本語</span>
        </a>
      </li>
      
      <li>
        <a href="/es/basic/regression/ridge_and_lasso/">
          <span>Español</span>
        </a>
      </li>
      
      <li>
        <a href="/id/basic/regression/ridge_and_lasso/">
          <span>Indonesia</span>
        </a>
      </li>
      
    </ul>
  </li>
</ul>














  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/" class="">Linear Regression</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/linear_regression/" class="">Least-squares method</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/ridge_and_lasso/" class="active">Ridge and Lasso regression</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/regression/robust_regression/" class="">Outliers and Robustness</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/classification/" class="">Linear Classification</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/classification/logistic_regression/" class="">Logistic Regression</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/classification/linear_discriminant_analysis/" class="">Linear Discriminant Analysis</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/" class="">Decision Tree</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/decision_tree_classifier/" class="">Decision Tree (Classification)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/decision_tree_regressor/" class="">Decision tree (regression)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/tree/parameter/" class="">Decision Tree Parameters</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/" class="">Ensemble</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/randomforest/" class="">Random Forests</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/stucking/" class="">Stacking</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/adaboost_classification/" class="">Adaboost (classification)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/adaboost_regression/" class="">Adaboost(Regression)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/ensemble/gradient_boosting1/" class="">Gradient boosting</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/" class="">Clustering</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/k-means1/" class="">k-means</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/k-means2/" class="">k-means&#43;&#43;</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/clustering/x-means/" class="">X-means</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/" class="">Dimensionality Reduction</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/pca/" class="">PCA</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/svd/" class="">SVD</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/lda/" class="">LDA</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/dimensionality_reduction/kernel-pca/" class="">Kernel-PCA</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/feature_selection/" class="">Feature Selection</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/timeseries/" class="">Time Series</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/timeseries/prophet/" class="">Using Prophet</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/anomaly/" class="">Anomaly detection</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/basic/anomaly/adtk1/" class="">Anomaly Detection ①</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/basic/anomaly/adtk2/" class="">Anomaly Detection②</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Ridge and Lasso regression</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#import-required-modules">Import required modules</a></li>
    <li><a href="#generate-regression-data-for-experiments">Generate regression data for experiments</a></li>
    <li><a href="#compare-least-squares-ridge-regression-and-lasso-regression-models">Compare least squares, ridge regression, and lasso regression models</a></li>
    <li><a href="#compare-the-values-of-the-coefficients-for-each-model">Compare the values of the coefficients for each model</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><!-- raw HTML omitted -->
<h2 id="import-required-modules">
  Import required modules
  
  <a class="anchor" href="#import-required-modules">#</a>
  
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> japanize_matplotlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_regression
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LinearRegression, Ridge, Lasso
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> make_pipeline
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
</span></span></code></pre></div><h2 id="generate-regression-data-for-experiments">
  Generate regression data for experiments
  
  <a class="anchor" href="#generate-regression-data-for-experiments">#</a>
  
</h2>

<div class="notices document" ><p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_regression.html">sklearn.datasets.make_regression</a></p>
</div>

<p>Artificially generate regression data using <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_regression.html">sklearn.datasets.make_regression</a>. Specify two features (<code>n_informative</code> = 2) as necessary for prediction. Otherwise, they are redundant features that are not useful for prediction.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>n_features <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>n_informative <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>X, y <span style="color:#f92672">=</span> make_regression(
</span></span><span style="display:flex;"><span>    n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>,
</span></span><span style="display:flex;"><span>    n_features<span style="color:#f92672">=</span>n_features,
</span></span><span style="display:flex;"><span>    n_informative<span style="color:#f92672">=</span>n_informative,
</span></span><span style="display:flex;"><span>    noise<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>,
</span></span><span style="display:flex;"><span>    random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">777</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>concatenate([X, np<span style="color:#f92672">.</span>log(X <span style="color:#f92672">+</span> <span style="color:#ae81ff">100</span>)], <span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># Add redundant features</span>
</span></span><span style="display:flex;"><span>y_mean <span style="color:#f92672">=</span> y<span style="color:#f92672">.</span>mean(keepdims<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>y_std <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>std(y, keepdims<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> (y <span style="color:#f92672">-</span> y_mean) <span style="color:#f92672">/</span> y_std
</span></span></code></pre></div><h2 id="compare-least-squares-ridge-regression-and-lasso-regression-models">
  Compare least squares, ridge regression, and lasso regression models
  
  <a class="anchor" href="#compare-least-squares-ridge-regression-and-lasso-regression-models">#</a>
  
</h2>
<p>Let&rsquo;s train each model with the same data and see the differences.
Normally, the coefficient alpha of the regularization term should be changed, but in this case, it is fixed.</p>

<div class="notices document" ><ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html">sklearn.pipeline.make_pipeline</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html">sklearn.linear_model.LinearRegression</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html#sklearn.linear_model.Ridge">sklearn.linear_model.Ridge</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html#sklearn.linear_model.Lasso">sklearn.linear_model.Lasso</a></li>
</ul>
</div>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>lin_r <span style="color:#f92672">=</span> make_pipeline(StandardScaler(with_mean<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>), LinearRegression())<span style="color:#f92672">.</span>fit(X, y)
</span></span><span style="display:flex;"><span>rid_r <span style="color:#f92672">=</span> make_pipeline(StandardScaler(with_mean<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>), Ridge(alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>))<span style="color:#f92672">.</span>fit(X, y)
</span></span><span style="display:flex;"><span>las_r <span style="color:#f92672">=</span> make_pipeline(StandardScaler(with_mean<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>), Lasso(alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>))<span style="color:#f92672">.</span>fit(X, y)
</span></span></code></pre></div><h2 id="compare-the-values-of-the-coefficients-for-each-model">
  Compare the values of the coefficients for each model
  
  <a class="anchor" href="#compare-the-values-of-the-coefficients-for-each-model">#</a>
  
</h2>
<p>Plot the absolute value of each coefficient. It can be seen from the graph that for linear regression, the coefficients are almost never zero. We can also see that Lasso regression has coefficients = 0 for all but the features needed for prediction.</p>
<p>Since there were two useful features (<code>n_informative = 2</code>), we can see that linear regression has unconditional coefficients even on features that are not useful, while Lasso-Ridge regression could not be narrowed down to two features. Still, it resulted in many unwanted features having coefficients of zero.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feat_index <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(X<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>])])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>bar(
</span></span><span style="display:flex;"><span>    feat_index <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>    np<span style="color:#f92672">.</span>abs(lin_r<span style="color:#f92672">.</span>steps[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>coef_),
</span></span><span style="display:flex;"><span>    width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>    label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;LinearRegression&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>bar(feat_index, np<span style="color:#f92672">.</span>abs(rid_r<span style="color:#f92672">.</span>steps[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>coef_), width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;RidgeRegression&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>bar(
</span></span><span style="display:flex;"><span>    feat_index <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>    np<span style="color:#f92672">.</span>abs(las_r<span style="color:#f92672">.</span>steps[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>coef_),
</span></span><span style="display:flex;"><span>    width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>    label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;LassoRegression&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$\beta$&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$|\beta|$&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span></code></pre></div><p><img src="/images/basic/regression/02_Ridge_and_Lasso_files/02_Ridge_and_Lasso_10_1.png" alt="png" /></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/en/basic/regression/linear_regression/" class="flex align-center book-icon">
        <img src="/svg/backward.svg" class="book-icon" alt="Previous" title="Least-squares method" />
        <span>Least-squares method</span>
      </a>
    
    </span>
    <span>
    
      <a href="/en/basic/regression/robust_regression/" class="flex align-center book-icon">
        <span>Outliers and Robustness</span>
        <img src="/svg/forward.svg" class="book-icon" alt="Next" title="Outliers and Robustness" />
      </a>
    
    </span>
  </div>
  




  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 
      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    

<aside class="book-toc">
  <div class="book-toc-content">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#import-required-modules">Import required modules</a></li>
    <li><a href="#generate-regression-data-for-experiments">Generate regression data for experiments</a></li>
    <li><a href="#compare-least-squares-ridge-regression-and-lasso-regression-models">Compare least squares, ridge regression, and lasso regression models</a></li>
    <li><a href="#compare-the-values-of-the-coefficients-for-each-model">Compare the values of the coefficients for each model</a></li>
  </ul>
</nav>



  </div>
</aside>

 
  </main>

  
</body>
</html>
















